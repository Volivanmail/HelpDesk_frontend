(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const n=new Uint8Array(16);function o(){if(!t&&(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}const c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));const s=function(t,n,s){if(e.randomUUID&&!n&&!t)return e.randomUUID();const a=(t=t||{}).random||(t.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n){s=s||0;for(let e=0;e<16;++e)n[s+e]=a[e];return n}return function(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}(a)};class a{constructor(e){this.name=e}create(){const e=document.createElement("form");e.method="POST",e.action="http://localhost:8080",e.classList="popup",e.textContent=this.name,document.body.contains(document.querySelector(".popup"))||document.body.appendChild(e);const t=document.createElement("input");t.required=!0,t.type="text",t.placeholder="Краткое описание",e.appendChild(t);const n=document.createElement("textarea");n.required=!0,n.placeholder="Подробное описание",e.appendChild(n);const o=document.createElement("button");o.textContent="Ok",e.appendChild(o);const c=document.createElement("button");return c.textContent="Отмена",e.appendChild(c),c.addEventListener("click",(()=>{e.remove()})),{popup:e,taskName:t,taskDesc:n,submit:o}}}async function r(e){const t={id:e.parentElement.querySelector(".id").textContent,name:e.parentElement.querySelector(".taskName").textContent,description:e.parentElement.querySelector(".taskDesc").textContent,status:!!e.parentElement.querySelector(".checkbox").checked,created:e.parentElement.querySelector(".created").textContent};try{const e=await fetch("http://localhost:8080/",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await e.json();console.log("Success:",n)}catch(e){console.error("Error:",e)}}class d{constructor(e,t,n,o,c){this.id=e,this.name=t,this.status=n,this.created=o,this.description=c}view(){const e=document.createElement("li");e.classList="li";const t=document.createElement("span");t.classList="id",t.textContent=this.id,e.appendChild(t);const n=document.createElement("input");n.type="checkbox",n.classList="checkbox",n.name="status",this.status&&(n.checked=!0),e.appendChild(n),n.addEventListener("click",(()=>{r(n)}));const o=document.createElement("span");o.classList="taskName",o.textContent=this.name,e.appendChild(o);const c=document.createElement("p");c.classList="taskDesc desc-hide",c.textContent=this.description,e.appendChild(c),this.descriptionView(e);const s=document.createElement("div");s.classList="created",s.textContent=this.created,e.appendChild(s);const a=document.createElement("button");a.classList="btnMod",e.appendChild(a),this.taskModifying(a);const d=document.createElement("button");return d.classList="btnDel",e.appendChild(d),this.taskDelete(d),e}descriptionView(e){e.querySelector(".taskName").addEventListener("click",(()=>{const t=e.querySelector(".taskDesc");t.classList.contains("desc-hide")?t.classList.remove("desc-hide"):t.classList.toggle("desc-hide")}))}taskModifying(e){e.addEventListener("click",(()=>{const t=new a("Изменить тикет").create();t.taskName.value=e.parentElement.querySelector(".taskName").textContent,t.taskDesc.value=e.parentElement.querySelector(".taskDesc").textContent,t.submit.addEventListener("click",(n=>{n.preventDefault(),e.parentElement.querySelector(".taskName").textContent=t.taskName.value,e.parentElement.querySelector(".taskDesc").textContent=t.taskDesc.value,t.popup.remove(),r(e)}))}))}taskDelete(e){e.addEventListener("click",(()=>{const t=document.createElement("form");if(t.classList="popup",t.textContent="Удалить тикет",!document.body.contains(document.querySelector(".popup"))){document.body.appendChild(t);const n=document.createElement("div");n.textContent="Вы уверены, что хотите удалить тикет? Это действие необратимо...",t.appendChild(n);const o=document.createElement("button");o.textContent="Ok",t.appendChild(o),o.addEventListener("click",(n=>{n.preventDefault(),e.parentElement.remove(),t.remove(),async function(e){try{const t=await fetch(`http://localhost:8080/${e.parentElement.querySelector(".id").textContent}`,{method:"DELETE"}),n=await t.json();console.log("Success:",n)}catch(e){console.error("Error:",e)}}(e)}));const c=document.createElement("button");c.textContent="Отмена",t.appendChild(c),c.addEventListener("click",(()=>{t.remove()}))}}))}}document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.createElement("button");e.classList="btn",e.textContent="Добавить тикет",document.body.appendChild(e);const t=document.createElement("ul");t.classList="ul",document.body.appendChild(t),e.addEventListener("click",(()=>{const e=new a("Добавить тикет").create();e.submit.addEventListener("click",(n=>{n.preventDefault();const o=new d(s(),e.taskName.value,!1,function(e){function t(e){return e.length<2&&(e=`0${e}`),e}return`${t(String(e.getUTCDate()))}.${t(String(e.getUTCMonth()+1))}.${String(e.getFullYear()).slice(-2)} ${t(String(e.getHours()))}:${t(String(e.getMinutes()))}`}(new Date),e.taskDesc.value);e.taskName.value&&e.taskDesc.value&&(t.appendChild(o.view()),async function(){const e=[];document.querySelectorAll(".li").forEach((t=>{e.push({id:t.querySelector(".id").textContent,name:t.querySelector(".taskName").textContent,description:t.querySelector(".taskDesc").textContent,status:!!t.querySelector(".checkbox").checked,created:t.querySelector(".created").textContent})}));try{const t=await fetch("http://localhost:8080/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();console.log("Success:",n)}catch(e){console.error("Error:",e)}}()),e.popup.remove()}))})),fetch("http://localhost:8080/").then((e=>e.json())).then((e=>{e.forEach((e=>{const n=new d(e.id,e.name,e.status,e.created,e.description);t.appendChild(n.view())}))}))}()}))})();